##################################################################################
#                     Makefile for UTIL test for cuRNN                           #
##################################################################################

TARGET 					:= util_tests

##################################################################################
#                                  COMPILERS                                     #
##################################################################################

CXX 					:= nvcc
LXX                     := nvcc 

##################################################################################
#                                INPUT FILES                                     #
##################################################################################

CPP_FILES				:= tests_util.cpp

##################################################################################
#                                   OBJECTS                                      #
##################################################################################

OBJS 					= $(CPP_FILES:.cpp:=.o)

##################################################################################
#                                  COMPILER FLAGS                                #
##################################################################################

CXX_FLAGS				:= 

##################################################################################
#                                  GENCODE FLAGS                                 #
##################################################################################

GENCODE_FLAGS         	:= -gencode arch=compute_20,code=sm_20

##################################################################################
#                                   LIBRARIES                                    #
##################################################################################

CUDA_LIBS				:= 
CPP_LIBS				:= -lgtest

##################################################################################
#                                    BUILDING                                    #
##################################################################################

.PHONY: all 

all: $(OBJS)
	$(CXX) $(GENCODE_FLAGS) $(OBJS) $(CUDA_LIBS) $(CPP_LIBS) -o $(TARGET)

%.o: %.cpp
	$(LXX) $(CXX_FLAGS) -x cu $(GENCODE_FLAGS) -I. -dc $< -o $@

clean:
	rm -f *.o $(TARGET)